# 《概率统计》 day 45

今天是读《概率统计》的逻辑第 45 天，学习 Test of Goodness-of-Fit，有点像多项分布。

一个总体有 k 种不同类型，每种类型的概率是 $\vec{p} = (p_1, ..., p_k)$，一次随机采样种，统计每种的数量是 $N_1, ..., N_k$，检验

$$
H_0: \vec{p} = (p_1^0, ..., p_k^0)
$$

它描述这样一个场景，随机样本一共有 k 种不同类型，每种的数量是 $N_1, ..., N_k$

它描述由 k 种不同类型组成的样本，每种类型的概率是 $p_i$，假设

$$
H_0: p_i = p_i^0
$$

$$
H_1: p_i \ne p_i^0
$$

统计

$$
Q = \sum_{i=1}^k \frac{(N_i - np_i^0)^2}{np_i^0}
$$

当 $n -> \infty$ 是自由度 k - 1 的 $\chi^2$ 分布。

有一份数据，统计 Aa 基因的爹妈后台是什么基因，初中生物让我们合理假设

||AA|Aa|aa|
|--|--|--|--|
|数量|10|10|4|
|概率|1/4|1/2|1/4|
|np<sub>i</sub><sup>0</sup>|6|12|6|

那么

$$
Q = \frac{(10-6)^2}{6} + \frac{(10-12)^2}{12} + \frac{(4-6)^2}{6} = 11/3
$$

Q 是自由度 2 的 $\chi^2$ 分布，$p(Q \ge 11/3) = 0.16$

这种假设检验有点怪，上一章的假设大多是反着来的，都是希望拒绝 $H_0$，它这个似乎不是为了拒绝 $H_0$。

如果 $\alpha_0 \gt 0.16$ 那么拒绝 $H_0$。

这种方法还有种很怪的用法，检验连续分布，比如正态分布。

它先把连续分布分成几个区间，原则上每个区间的概率近似相等且不能太小。

比如按概率五等分的标准正态分布，每个区间就是

-inf, -0.8416, -0.2533, 0.2533, 0.8416, inf

也可以直接对 x

-inf, -0.75, -0.25, 0.25, 0.75, inf

0.2266, 0.1747, 0.1974, 0.1747, 0.2266

接下来的操作就一样了，只是都知道 X 的分布了，直接用不好么，还特意拆成小区间，有点脱裤子放屁的感觉。

更进一步，如果 $p_i$ 不是常量，而是函数，父母的 A 有 $\theta$ 的概率传递给子女，那么

$p_1 = \theta^2, p2= 2 \theta(1-\theta), p_3 = (1-\theta)^2$

$$
H_0: p_i = \pi_i(\theta)
$$

这时候统计 Q 调整为

$$
Q = \sum_{i=1}^k \frac{(N_i - n\pi_i(\hat{\theta}))^2}{n\pi_i(\hat{\theta})}
$$

是自由度 k - 1 - s 的 $\chi^2$ 分布

$$
L(\theta) = \binom{n}{N_1, ..., N_k} \prod_{i=1}^{k} [\pi_i(\theta)]^{N_i}
$$

$$
log L (\theta) = log \binom{n}{N_1, ..., N_k} \sum_{i=1}^{k} N_i[\pi_i(\theta)]
$$

MLE $\hat{\theta}$ 是的 $log L (\theta)$ 最大，上面的例子那就是最大化

$$
\begin{aligned}
log L(\theta) &= N_1 log \theta^2 + N_2 log 2\theta(1-\theta) + N_3 log(1-\theta)^2 + c\\
&=(2N_1 + N_2)log \theta + (2N_3 + N_2) log (1 - \theta) + c
\end{aligned}
$$

求导

$$
\frac{\partial log L(\theta)}{\partial \theta} = \frac{2N_1 + N_2}{\theta} - \frac{2N_3 + N_2}{1-\theta}
$$

导数等于零解出 $\hat{\theta} = (2N_1 + N_2) / 2n$，带入 10 10 4 得到 $\hat{\theta} = 5/8$

$\pi_1(\hat{\theta}) = 25 / 64$

$\pi_2(\hat{\theta}) = 30 / 64$

$\pi_3(\hat{\theta}) = 9 / 64$

||AA|Aa|aa|
|--|--|--|--|
|数量|10|10|4|
|π$_i(\hat{\theta})$|25/64|30/64|9/64|
|nπ$_i(\hat{\theta})$|75/8|90/8|27/8|

$$
Q = \frac{(10-75/8)^2}{75/8} + \frac{(10-90/8)^2}{90/8} + \frac{(4-27/8)^2}{27/8} = 0.2963
$$

是自由度 1 的 $\chi^2$ 分布，$p(Q \ge 0.2963) = 0.5862$

但是有时候直接计算 $log L (\theta)$ 的 MLE 不容易计算，可以退而求其次，计算 X 的 MLE，这时候

$$
Q' = \sum_{i=1}^k \frac{(N_i - n\pi_i(\hat{\theta}))^2}{n\pi_i(\hat{\theta})}
$$

当 $n -> \infty$ $Q'$ 的 cdf 介于自由度 k - 1 -s 和 k - 1 的 $\chi^2$ 之间。


样本平均数 67.6，样本方差 1

|身高|数量|
|--|--|
|＜ 66|18|
|66 ~ 67.5|177|
|67.5 ~ 68.5|198|
|68.5 ~ 70|102|
|＞ 70|5|

$\hat{\theta} = (67.6, 1)$

$\pi_1(\hat{\theta}) = 0.0548$

$\pi_2(\hat{\theta}) = 0.4054$

$\pi_3(\hat{\theta}) = 0.3557$

$\pi_4(\hat{\theta}) = 0.1759$

$\pi_5(\hat{\theta}) = 0.0082$

$Q' = 11.2$

封面图：Twitter 心臓弱眞君 @xinzoruo