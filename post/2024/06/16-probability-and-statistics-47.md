# 《概率统计》 day 47

今天是读《概率统计》的逻辑第 47 天，学习辛普森悖论，同样的统计数据可以得出完全相反的结论。

一项关于新治疗方案的报告

|男|提升|未提升|比例|
|--|--|--|--|
|新方案|12|18|40%|
|旧方案|3|7|30%|

|女|提升|未提升|比例|
|--|--|--|--|
|新方案|8|2|80%|
|旧方案|21|9|70%|

无论男女，新方案的效果都好于旧方案，虽然不多，现在把数据合起来

||提升|未提升|比例|
|--|--|--|--|
|新方案|20|20|50%|
|旧方案|24|16|60%|

哦吼，结论反过来了。

导致这个现象的原因是无论新旧方案，女性的效果远远好于男性，且大比例的女性被分配到旧方案。

用集合表示

+ 事件 A 表示被试是男性，那么 $A^c$ 表示女性
+ 事件 B 表示被试用新方案，那么 $B^c$ 表示用旧方案
+ 事件 I 表示效果提升，那么 $I^c$ 表示未提升

那么辛普森悖论可以描述为下面三个不等式同时成立

$P(I|A \cap B) \gt P(I|A \cap B^c)$

$P(I|A^c \cap B) \gt P(I|A^c \cap B^c)$

$P(I|B) \lt P(I|B^c)$

要破除它也很简单，只需 $P(A|B) = P(A|B^c)$ 即新方案中男性的比例和旧方案中男性的比例相同。这个等式还暗示 $P(A^c|B) = P(A^c|B^c)$ 即新旧方案的女性比例也相同。

根据条件概率的定义

$$
\frac{P(A \cap B)}{P(B)} = \frac{P(A \cap B^c)}{P(B^c)} = \frac{P(A \cap B^c)}{1 - P(B)}
$$

化简得到

$$
\begin{aligned}
P(A \cap B) &= P(B)[P(A \cap B) + P(A \cap B^c)] \\
&= P(B)P(A)
\end{aligned}
$$

说明 A B 独立。

$$
\begin{aligned}
P(I|B) &= P(I |A \cap B)P(A|B) + P(I |A^c \cap B)P(A^c|B) \\
&=P(I |A \cap B)P(A) + P(I |A^c \cap B)P(A^c)
\end{aligned}
$$

同理

$$
\begin{aligned}
P(I|B^c) &= P(I |A \cap B^c)P(A|B) + P(I |A^c \cap B^c)P(A^c|B) \\
&=P(I |A \cap B^c)P(A) + P(I |A^c \cap B^c)P(A^c)
\end{aligned}
$$

这时候三个等式就不可能同时成立了。

怪不得临床报告（day42）有一项 Baseline Characteristics，用来展示两个方案被试的特征（年龄、性别、种族）。

这也能解释为什么身边人个个都苦逼，但“整个国家都洋溢着乐观向上的氛围”，这两件事情的确能同时发生。

封面图：Twitter 心臓弱眞君 @xinzoruo