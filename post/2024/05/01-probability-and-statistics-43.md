# 《概率统计》 day 43

今天是读《概率统计》的逻辑第 43 天，继续比较两个正态分布，这次比较方差。

用到一个新分布：F 分布，比较好奇这段为什么没放到第八章。

Y 是自由度 m 的 $\chi^2$ 分布，W 是自由度 n 的 $\chi^2$ 分布，那么

$$
X = \frac{Y/m}{W/n}
$$

是自由度 m，n 的  F 分布。

它有非常复杂的 pdf 公式，但现在有计算机，`scipy.stats.f` 可以轻松拿捏，只是它居然就叫 f，占我一个常用的变量名。

统计

$$
V = \frac{S_X^2/(m-1)}{S_Y^2/(n-1)}
$$

当 $\sigma_X^2 = \sigma_Y^2$ 时，是自由度 m - 1, n - 1 的 F 分布，不等时 $V^* = \frac{\sigma_Y^2}{\sigma_X^2}V$ 是 F 分布

$$
P(V \ge c) = P(\frac{\sigma_Y^2}{\sigma_X^2}V \ge \frac{\sigma_Y^2}{\sigma_X^2}c) = 1 - F_{m-1,n-1}(c)
$$

不同的假设，有不同的 $\delta$ 和 p 值

|H<sub>0</sub>|δ|p 值|
|--|--|--|
|$\sigma_1^2$ ≤ $\sigma_2^2$|V $\ge F^{-1}_{m-1,n-1}(1-\alpha_0)$|1 - $F_{m-1,n-1}(v)$|
|$\sigma_1^2$ = $\sigma_2^2$|$V \le c_1$ 或 $V \ge c_2$|2 $\min\{1-F_{m-1,n-1}(v), F_{m-1,n-1}(v)\}$|

$c_1, c_2$ 理论上可以取任何值，只要满足 $P(V \le c_1) + P(V \ge c_2) = \alpha_0$，通常各取一半，$c_1 = F^{-1}_{m-1,n-1}(\alpha_0/2)$，$c_2 = F^{-1}_{m-1,n-1}(1-\alpha_0/2)$。

这个感觉用处不大的样子，正常会有比较方差的需求么。

算了还是拿替诺福韦的数据来算算看

||TDF|ADV|
|--|--|--|
|Week 48|102|97|
||-6.4(0.86)|-4.4(1.69)|
|Week 96|101|97|
||-6.5(0.86)|-6.5(0.81)|

方差小说明药效稳定，不容易上蹿下跳，想要证明 TDF 比 ADV 稳定，反向假设

$$
H_0: \sigma_{ADV}^2 \le \sigma_{TDF}^2
$$
$$
H_1: \sigma_{ADV}^2 \gt \sigma_{TDF}^2
$$

统计

$$
v_{48} = \frac{1.69^2*97/96}{0.86^2*102/101} = 3.9405
$$

$p_{48} = 1 - F_{96, 101}(v_{48})$ 几乎为零，拒绝 $H_0$

改一改假设

$$
H_0: \sigma_{ADV}^2 = r \sigma_{TDF}^2
$$
$$
H_1: \sigma_{ADV}^2 \ne r \sigma_{TDF}^2
$$

显著性等级设为 $\alpha_0 = 0.05$

$c_1 = F_{96, 101}^{-1}(0.05/2) * r = 0.6337r$

$c_2 = F_{96, 101}^{-1}(1 - 0.05/2) * r = 1.5741r$

$\delta$: 如果 $V \le 0.6337r$ 或 $V \ge 1.5741r$ 拒绝 $H_0$

$v_{48} = 3.9405$ 那么 r = 1 拒绝，r = 2 拒绝，r = 3 不拒绝

$2.5033 \le r \le 6.2182$ 不拒绝 $H_0$

封面图：Twitter 心臓弱眞君 @xinzoruo