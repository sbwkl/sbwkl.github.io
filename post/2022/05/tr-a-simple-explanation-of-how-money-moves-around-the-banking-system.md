# 银行系统如何实现转账

*注意：下面内容仅用于理解，我不是从业人员，不知道银行具体怎么弄*

<!-- 首先建立一些共识。我们在银行的存款是银行的负债，相当于把钱借给银行。银行不会老实的把钱保存在仓库里，并且写上这是某某某的钱。同理信用卡是银行借钱给我们，所以往信用卡里充钱，余额会变成负的，第一次看到的时候吓一跳。 -->

同行转账，Alice 给 Bob 转￥10。

转账时，工行先从张三账户收到 10 块钱，然后给李四的账户 10 块钱，这个时候张三和银行两清了，工行欠李四 10 块。

![](https://gendal.files.wordpress.com/2013/11/single-bank-settlement.png)

假设李四用的不是工行，而是中行，这时候就是跨行转账。工行把张三的账户 -10 是容易的，但是要怎么说服中行给李四的账户 +10。

有一种办法是中行作为客户在工行开设账户，这时候流程变成

1. 工行操作张三账户 -10
2. 工行操作中行账户 +10
3. 工行通知中行给李四账户 +10
4. 中行收到消息，知道自己的账户 +10
5. 中行操作李四账户 +10

这时候张三和工行两清，工行欠中行 10 块，中行欠李四 10 块。

![](https://gendal.files.wordpress.com/2013/11/correspondent-banking.png)

这种方式叫做代理银行。大多数时候工作都很 OK 主要存在两个缺陷

1. 银行之间需要互相开户才行，不然的话可能要借助其他银行当跳板绕一圈才能转账。
2. 有风险。比如上面例子的中行要承担工行不还钱的风险，工行肯定不会的，但是如果换成不知名小银行，转账的金额特别大，比如 1 个小目标，这时候中行就要考虑考虑，是否接这个业务。

老美的 SWIFT 可以理解是干这个事情的，如果被踢出这个系统，那转账的成本就更高了。

从大体上看，两家银行的客户互相转账的体量应该是差不多的，每笔交易都这么操作成本又高，还占用不少的资金（要预留给转账用）这样就衍生出 deferred net settlement 系统。它负责跟踪所有的交易，然后统计一个周期内计算每家银行的净值，然后结算，这大大提高了效率，还省钱。

![](https://gendal.files.wordpress.com/2013/11/deferred-net-settlement.png)

这种方式可能引入新问题：因为结算是延迟的，用户申请转账，但是资金可能还没到银行，这时候银行有两个选择，1）等资金到了在完成业务，这样做引入延迟。2）承担风险直接完成业务，这样做万一对方公司破产了，需要逆转这笔交易，丧失结算最终性(settlement finality)。

想要交易即实时又具有结算最终性，哪怕银行虽有破产，需要所有银行在一家不会破产的银行开户，即中央银行。

这个思考激发实时全额支付系统（Real-Time Gross Settlement）的想法。

![](https://gendal.files.wordpress.com/2013/11/rtgs.png)


之前一直有听说虚拟货币（如比特币）可以解决信任问题，一直不理解，也没想过一个转账能这么复杂。我以前还喷跨行转账咋还要手续费，穷疯了吧，现在想想，是我唐突了。

虚拟货币和 RTGS 系统有点像，实时、结算、最终性，最牛逼的是不需要中央银行这样的机构。

看完文章后我又看了下复式记账法，因为我搞不清 debit 和 credit，对于转账又有了别的理解。

以存款为例，假设 Alice 存了￥10。那么从 Alice 的视角账本应该是这样的。

|Assert||
|:--:|:--:|
|Debits (Dr) | Credits (Cr)|
||10|