# 《编译原理》 day 23

今天是读《编译原理》的逻辑第 23 天，开始学习语法分析。

这节没多少新内容了，大多是回顾第 2 章语法相关的内容，像上下文无关文法、自顶向下、自底向上。

新增语法错误处理，包括错误分级和恢复策略。

不同层级的错误

1. 词法错误，比如关键字、标识符拼写错误，字符串缺少引号
2. 语法错误，比如分号位置不对，缺失花括号
3. 语义错误，比如操作符和操作数不匹配，函数返回类型不匹配
4. 逻辑错误，这个已经算是 bug 了，比如要写 == 的地方写了 =，比较语句变成了赋值语句

错误恢复策略

1. 恐慌模式恢复：这种模式遇到错误就丢弃下一个输入字符，直到遇到 synchronizing token（同步词法单元），通常是分号，花括号这些清晰无歧义的终止符。叫恐慌的都喜欢删字符是吧。这个模式最大的优点是简单，不会死循环
2. 短语层次恢复：这种模式遇到错误会尝试纠正，将某个前缀替换为另外的串，比如逗号替换分好，删除或添加分号，要注意别死循环了
3. 错误产生式：添加专门针对常见错误的产生式，一旦使用这个产生式，那就说明出错了，这个思路还蛮有意思的，钓鱼执法
4. 全局纠正：理论阶段的策略，达不到实际使用。理想状态下希望编译器通过最少的变动纠正错误，得到开销最低的全局纠正方法

另外虽然编译器可以纠正错误，不代表纠正的结果是程序员想要的，不然的话压力就来到程序员这边了。

封面图：Twitter 心臓弱眞君 @xinzoruo