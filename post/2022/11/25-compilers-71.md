# 《编译原理》 day 71

今天是读《编译原理》的逻辑第 71 天，学习机器无关优化。

不要啊，怎么还有优化，这次还是全局优化。

唉，还是慢慢啃吧。

优化的主要来源是冗余，这个确实，以前有见过代码重复率接近 50% 的项目，源代码层面都有这么多重复，更不用说转成三地址代码了。

再一个有些冗余也是需要的，提升可读性。

这是快排算法的三地址代码，接下来要对它进行优化以展示全局优化有哪些项目

![](25-graph-1.png)

B_5 的 4 * i 和 4 * j 可以消除 t_6 代替 t_7，t_8 代替 t_10，这是上一张的内容。

消除之后 B_3 有计算 4 * j 且 j 并未发生变化。t_4 可以替换 t_8 

全局公共字表达式，这个和局部一样

经过公共子表达式消除后，流图变为

![](25-graph-2.png)

复制传播，如果有 u = v 的赋值表达式，如果 u 没有发生变化，那么使用 u 的地方，用 v 代替。复制传播本身不能优化什么，但经过这个行为后，可能发现新的可优化点。

B_5 应用复制传播后，x 用 t_3 代替。

死代码消除，消除那些计算了，但是没用的代码。

变量死活的定义是在程序某个点，它的值在后续被使用那么变量在这个点是 live（活跃），否则就是 dead（死的）

B_5 经过复制传播后，变量 x 是死的，直接消除。

