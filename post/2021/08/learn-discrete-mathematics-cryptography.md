# 一起学离散数学：密码学

密码学可以追溯到两千多年前凯撒大帝，他发明了一种加密方式把明文的每个字符向后移动 3 位。为了方便理解，假设凯撒大帝说英语，用字母 a-z 写信，那么如果凯撒大帝想写一封内容为 hello world 的信，他加密后的内容应该是 khoor zruog。

为了方便运算，把 a-z 映射为数字 0-25 那么凯撒密码可以表示为 f(p) = (p + 3) mod 26。符号 mod 表示模运算，意思是除 26 取余数。比如信中的 h 对应数字 7，f(8) = (7 + 3) mod 26 = 10 对应字符 k。有加密就有解密，解密就是把加密的过程反过来 p = (f(p) - 3) mod 26。

可以用更加通用的公式表示凯撒密码 f(p) = (p + k) mod 26 其中 k 叫做安全密钥，持有相同密钥的双方可以正常加解密通信。

随着密码学的出现，同时出现了另两项技术密码分析和密码破译，光与暗总是相生相伴。其中一种破译方式是对比字符出现的概率，通过一些语料可以统计出字符的出现概率这个是已知的。然后统计出密文出现频率最高的字符，然后假设这 2 个字符相等解出 k 然后进行解密，看看解出来的文字是否有意义，如果有意义认为破解完成，如果没有意义换一个字符继续试。

凯撒密码很容易被破解，直接爆破都行，反正就 26 个字母。那么就需要对凯撒密码进行加固，一种方式是调整加密公式为 f(p) = (ap + b) mod 26 这时候对 a 的取值有要求，很显然 a = 26 肯定是不行的。

这里引入同余方程的概念，假设 a mod m = b mod m 那么就记为 $$a \equiv b \bmod m$$。