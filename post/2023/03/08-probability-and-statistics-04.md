# 《概率统计》 day 4

今天是读《概率统计》的逻辑第 4 天，学习多项式系数。

它描述这样一个问题：n 个球放入 k 个桶，每桶 n<sub>k</sub> 个球，有多少种结果。

通过组合公式求解，分成 k 步，第一步从 n 个球取 n<sub>1</sub> 个球放入一号桶，第二步从 n - n<sub>1</sub> 取 n<sub>2</sub> 个球放入二号桶，依次类推。

最后化简得到

$$
\frac{n!}{n_1!n_2!...n_k!}
$$

这个式子记作

$$
\binom{n}{n_1, n_2,..., n_k}
$$

记倒是蛮好记的。

当 k = 2 叫二项式，就是组合的公式

$$
\binom{n}{n_1, n - n_2} = \binom{n}{n_1}
$$

另外这个数是多项式展开后每项的系数

$$
(x_1 + ... + x_k)^n = \sum\binom{n}{n_1, n_2,..., n_k} x_1^{n_1}x_2^{n_2}...x_k^{n_k}
$$

感觉就挺离谱的，一个计数的方法还能歪到和这玩意儿有关系。

上面这个问题还有另一种描述，n 个球有 k 种不同颜色，每种 n<sub>k</sub> 个，有多少种排列结果。

这个描述就有点恶心，明明说的是排列结果，用的却是组合的公式，每次都要纠结一下才能转过来。

多项式这个问题描述的球和桶都是可区分的，如果允许不区分，衍生出另外三种情况

1. 球不区分，桶区分
2. 球区分，桶不区分
3. 球不区分，桶不区分

情形 2，3 直接跳过，巨复杂，感觉这辈子不可能遇上这种问题。感兴趣的可以看看《离散数学》第六章或者搜索关键词第二类斯特林数、Partitions of Integers 反正很牛逼就是了。

仅剩的一种情况和苹果、橘子、梨那个例子类似，公式是 C(n + k - 1, k)，它这个不同描述之间等价来等价去的好烦。

计数好尼玛难，这种难倒不是说解不出答案，更多的是套这个模型好像能解，套那个模型好像也能解，诶嘿，结果还不一样。

好消息是实际用到的可能性不大，不然就只能大力出奇迹，猛刷自然强。

这节还有个有意思的匹配问题，说的是 n 个人吃火锅，进门前脱了外套丢在一起，吃完后随机拿一件穿上走人，问至少有一个人拿回自己外套的概率。

结论是

$$
p_n = 1 - \frac{1}{2!} + \frac{1}{3!} - \frac{1}{4!} + ...
$$

当 n 趋向无穷 p<sub>n</sub> = 1 - (1 / e) ≈ 0.63212。

实际上，当 n = 7，p<sub>7</sub> = 3186 / 5040 ≈ 0.6321，已经很接近收敛结果了。

这个问题用到一个巨复杂的公式

$$
\begin{aligned}
P(\bigcup_{i = 1}^{n} A_i) &= \sum_{i = 1}^{n}P(A_i) - \sum_{i < j}^{}P(A_i \cap A_j) \\
&+ \sum_{i < j < k}^{}P(A_i \cap A_j \cap A_k) - ... \\
&+ (-1)^{n + 1} P(A_1 \cap A_2 \cap ... \cap A_n)
\end{aligned}
$$

比较熟悉的是两个事件的版本

$$
P(A_1 \cup A_2) = P(A_1) + P(A_2) - P(A_1 \cap A_2)
$$

然后假设事件 A<sub>i</sub> 是第 i 个人拿到自己外套，那么

$$
\begin{aligned}
P(A_i) &= \frac{1}{n} \\
P(A_i \cap A_j) &= \frac{1}{n(n - 1)} \\
P(A_i \cap A_j \cap A_k) & = \frac{1}{n(n - 1)(n - 2)} \\
&... \\
P(A_1 \cap A_2 \cap ... \cap A_n) &= \frac{1}{n!}
\end{aligned}
$$

代入公式

$$
\begin{aligned}
P(\bigcup_{i = 1}^{n} A_i) &= \binom{n}{1} P(A_i) - \binom{n}{2}P(A_i \cap A_j) \\
&+ \binom{n}{3}P(A_i \cap A_j \cap A_k) - ... \\
&+ (-1)^{n + 1} P(A_1 \cap A_2 \cap ... \cap A_n) \\
&= 1 - \frac{1}{2!} + \frac{1}{3!} -  ... + (-1)^{n + 1}\frac{1}{n!}
\end{aligned}
$$

数学家咋也和哲学家一样，思考这么诡异的问题。

封面图：Twitter 心臓弱眞君 @xinzoruo