# 《概率统计》 day 7

今天是读《概率统计》的逻辑第 7 天，学习贝叶斯定理。

定理本身很简单

$$
P(B_i|A) = \frac{P(B_i)P(A|B_i)}{\sum_{j=1}^{k}P(B_j)P(A|B_j)}
$$

它强就强在可以通过 P(A|B) 反过来计算 P(B|A)，说它逆转因果也不过分，Lancer 表示很赞。

假设某种疾病，患病的概率是 0.0001，检测它的试验只能保证 90% 可靠：如果一个人患病，那么结果阳性的概率 0.9，如果一个人没患病，那么阳性的概率是 0.1。

现在有个人检测结果是阳性，他患病的概率有多少，会不会是 90%，毕竟这个检测 90% 是可靠的。

根据描述梳理三个事件，计算的是结果是阳性时患病的概率 P(B<sub>1</sub>|A)

+ 事件 A：结果是阳性
+ 事件 B<sub>1</sub>：患者患病
+ 事件 B<sub>2</sub>：患者健康

事件 B<sub>i</sub> 是样本空间的一个 partition，正常情况下要么患病，要么健康。

$$
\begin{aligned}
P(B_1|A) &= \frac{P(B_i)P(A|B_1)}{P(B_1)P(A|B_1) + P(B_2)P(A|B_2)} \\
&=\frac{0.9 * 0.0001}{0.9 * 0.0001 + 0.1 * 0.9999} \\
&\approx 0.0009
\end{aligned}
$$

这个概率还是很小的，基本不需要过多担心。

这个例子把测试换成熬夜，就是网上常常能刷到的新闻：熬夜使某种病的概率提高 9 倍，听起来就有点焦虑。

但其实也可以这样说：熬夜使某种病的概率从 0.0001 提高到 0.0009，这听起来就没什么感觉了。

事儿还是这么件事，换个说法感受完全不一样。

这节纠正我对贝叶斯公式的理解，原本只知道

$$
P(B|A) = \frac{P(A|B)P(B)}{P(A)}
$$

以为这就是定理的全部，没想到还有 partition 这样的概念，怪不得以前理解一些案例总觉得有点别扭。

Augmented Experiment 这个概念很六。当预测某件事，比如预测某种疾病的治愈率，可以假设有 k 种可能，第 1 种治愈率 0，第 2 种治愈率 0.1，第 3 种治愈率 0.2，... 第 11 种治愈率 1。

数学的话说：B<sub>j</sub> 表示治愈率 p = (j - 1) / 10 的事件，共 11 个，假设每个事件的概率是 1 / 11。

事件 E<sub>i</sub> 表示第 i 病人的治愈情况，P(E<sub>i</sub>|B<sub>j</sub>) = (j - 1) / 10。

下面的计算假设事件 E 之间独立，也叫朴素（naive）贝叶斯。

预测第 1 个患者的治愈率

$$
\begin{aligned}
P(E_1) &= \sum_{j=1}^{11}P(E_1|B_j)*P(B_j) \\
&= \sum_{j=1}^{11}\frac{j - 1}{10}*\frac{1}{11} \\
&= 0.5
\end{aligned}
$$

如果观察到第 1 个患者治愈，根据贝叶斯定理

$$
\begin{aligned}
P(B_j|E_1) &= \frac{P(E_1|B_j)P(B_j)}{\sum_{j=1}^{11}P(E_1|B_j)P(B_j)} \\
&=\frac{\frac{j - 1}{10} * \frac{1}{11}}{\sum_{j=1}^{11}\frac{j-1}{10}*\frac{1}{11}} \\
&=\frac{j - 1}{55}
\end{aligned}
$$

这时候预测第 2 个患者治愈的概率是

$$
\begin{aligned}
P(E_2|E_1) &= \sum_{j=1}^{11}P(E_2|B_j \cap E_1)P(B_j|E_1) \\
&=\sum_{j=1}^{11}\frac{j-1}{10}*\frac{j-1}{55} \\
&= 0.7
\end{aligned}
$$

相比第一个有所提高。

如果观察到第 2 个患者也治愈，那么根据贝叶斯定理

$$
\begin{aligned}
P(E_1 \cap E_2|B_j) &= (\frac{j - 1}{10})^2 \\
P(B_j|E_1 \cap E_2) &= \frac{(\frac{j - 1}{10})^2 * \frac{1}{11}}{\sum_{j=1}^{11}(\frac{j - 1}{10})^2*\frac{1}{11}}
\end{aligned}
$$

如果观察到事件 A：40 人中有 22 人治愈，那么 P(B<sub>j</sub>|A)

|j|概率|
|--|--|
|1|0|
|2|7.0*10^-12|
|3|3.6*10^-6|
|4|0.0024|
|5|0.0831|
|6|0.4228|
|7|0.4205|
|8|0.0704|
|9|0.0009|
|10|4.6*10^-8|
|11|0|

*注：以上结果是我自己计算，不能保证 bug-free。*

事件 A 发生时，patition 6 和 7 的条件概率最大，根据假设 6 和 7 对应的治愈率是 0.5 和 0.6。

到这里的时候其实被惊艳到，但它后面补了一句 22 / 40 = 0.55 刚好在 6-7 之间，感情刚刚算了那么多，还不如直接直接除一下。

因为贝叶斯定理，P(B) 继边缘概率之后又有一个新名字，先验概率，相对的 P(B|A) 叫后验概率。

比较有意思的是即便先验概率随便乱写，观察 40 个样本后，后验概率依旧会收敛到上面的结果。

封面图：Twitter 心臓弱眞君 @xinzoruo