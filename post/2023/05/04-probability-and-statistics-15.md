# 《概率统计》 day 15

今天是读《概率统计》的逻辑第 15 天，学习马尔科夫链。

Long long age 学过一个等式

$$
P(A_1 \cap A_2 \cap ... \cap A_n) = P(A_1)P(A_2 | A_1)P(A_3 | A_1 \cap A_2) ... P(A_n | A_1 \cap A_2 \cap ... \cap A_{n - 1})
$$

计算 A<sub>1</sub> 到 A<sub>n</sub> 交集的概率，正常算，巨尼玛复杂。

然后一个机智的大胡子提出一个大胆的想法：他假设 A<sub>n</sub> 只和 A<sub>n-1</sub> 有关。

粗看有点扯，凭什么，看不起我 A<sub>n - 2</sub> 还是怎么着。

但是如果把 n 看成时间，一切似乎又合理起来了。

打个比方，众所周知，作为一个程序员，闲得蛋疼的时候看看书，玩玩手机，很正常吧。

又假设每十分钟看书有 40% 概率去玩手机，玩手机有 10% 概率去看书。

第 1 个十分钟记 X<sub>1</sub>，第 2 个十分钟记X<sub>2</sub>，第 n 个十分钟记 X<sub>n</sub>。

那 X<sub>2</sub> 只和 X<sub>1</sub> 有关，X<sub>3</sub> 只和 X<sub>2</sub> 有关，很合理吧，换我可能都记不得半个小时前在干啥。

这就是一个简易版马尔科夫链，它只有两个状态：看书（0）玩手机（1）。

根据描述有

$$
\begin{aligned}
P(X_{n+1} = 0|X_n = 0) = 60\% \\
P(X_{n+1} = 1|X_n = 0) = 40\% \\
P(X_{n+1} = 0|X_n = 1) = 10\% \\
P(X_{n+1} = 1|X_n = 1) = 90\%
\end{aligned}
$$

那么到底有多少时间在看书，多少时间在玩手机。

结论是只要蛋疼的时间够久，那么八成时间在玩手机，两成时间在看书。

上面啰里吧嗦的等式按照

$$
p_{ij} = P(X_{n+1} = j|X_n = i)
$$

简化为

$$
\boldsymbol{P} = \begin{bmatrix}
0.6 & 0.4 \\
0.1 & 0.9
\end{bmatrix}
$$

巧的是这个矩阵 m 次幂的第 i 行 j 列刚好是概率 P(X<sub>n + m</sub> = j|X<sub>n</sub> = i)。

经过 27 轮后固定不变

$$
\boldsymbol{P}^{27} = \begin{bmatrix}
0.2 & 0.8 \\
0.2 & 0.8
\end{bmatrix}
$$

无论初始分布 [a, b] 是多少，相乘后都一样

$$
[a, b]P^{27} = [0.2, 0.8]
$$

事实上 5 轮之后就很接近了

$$
\boldsymbol{P}^5 = \begin{bmatrix}
0.2125 & 0.7875 \\
0.1969 & 0.8031
\end{bmatrix}
$$

意味着无论怎么挣扎，怎么天胡开局，只要概率没变，世界线总会收束，一切都是命运石之门的选择。

转移矩阵中 p<sub>ii</sub> = 1 的状态叫吸收态（Absorbing State），就一黑洞，进去就出不来了，之前赌徒破产问题里的状态 0 和状态 k 都是吸收态。

封面图：Twitter 心臓弱眞君 @xinzoruo