# 《概率统计》 day 24

今天是读《概率统计》的逻辑第 24 天，学习各种各样的分布（下）。

**指数分布**

这个分布大概是用来建模等待时间的

$$
f(x|β) = βe^{-βx}
$$

$$
F(x|β) = 1 - e^{-βx}
$$

它的期望 $μ=\frac{1}{β}$，那么

$$
\begin{aligned}
P(X \gt μ)  &= 1 / e   &=0.3679\\
P(X \gt 2μ) &= 1 / e^2 &=0.1353\\
P(X \gt 3μ) &= 1 / e^3 &=0.0498\\
\end{aligned}
$$

假设某医院平均 5 分钟叫一个号，就是说等了 15 分钟还没叫下一号，赶紧找护士姐姐问问，是不是已经没号了，自己还过号了，来自一个傻傻等了半小时的冤大头。

偶尔也有特别衰的时候，比如电脑卡住了，打印机坏了，没纸啦，最难崩的是遇上来唠嗑的，半小时都算快的。

实际医院一早上四个小时放两百多个号，每个号就一分钟多点，好在基本约不完，不然那画面，不敢想。

那么如果前面还等着五个人，需要等多少时间？

**伽马分布**

$$
f(x|α, β) = \frac{β^α}{Γ(α)}x^{α - 1}e^{-βx}
$$

其中 $Γ(α)$ 叫伽马函数，是阶乘的扩展
<!-- 伽马分布和伽马函数密切相关，伽马函数是阶乘的扩展， -->
大概长这样

$$
Γ(α) = \int_0^{\infty}x^{α-1}e^{-x}dx
$$

很难想象，这个式子居然可以表示阶乘。$n!$ 就是 $Γ(n + 1)$

要证明

$$
\int_0^{\infty}f(x|α, β) = 1
$$

就要证明

$$
\int_0^{\infty}x^{α - 1}e^{-βx}dx = \frac{Γ(α)}{β^α}
$$

这个简单令 $x = \frac{y}{β}$ $dx=\frac{1}{β}dy$ 代入得到

$$
\int_0^{\infty}(\frac{y}{β})^{α - 1}e^{-y}\frac{1}{β}dy = \frac{1}{β^α}\int_0^{\infty}y^{α - 1}e^{-y}dy = \frac{Γ(α)}{β^α}
$$

它的矩母函数

$$
\begin{aligned}
\psi(t) &= E(e^{tX}) = \int_0^{\infty}e^{tx}f(x|α, β)dx \\
&= \int_0^{\infty}e^{tx}\frac{β^α}{Γ(α)}x^{α - 1}e^{-βx}dx \\
&= \frac{β^α}{Γ(α)}\int_0^{\infty}x^{α - 1}e^{-(β-t)x}dx \\
&=(\frac{β}{β-t})^α
\end{aligned}
$$

这个形状的矩母函数岂不是

$$
\psi(t) = \prod_{i=1}^{k}\psi_i(t)
$$

那么 k 个独立的，β 相同的伽马分布的和是 $α_1 + ... + α_k, β$ 的伽马分布。

回到前面五个人的问题，指数分布是 α = 1 的特殊伽马分布，那么等五个人就是 5 β 的伽马分布。


**帕累托分布**

伽马分布在 α < 1 的时候有点像幂律分布，我一度怀疑就是它，但在经过搜索后发现不对，幂律分布似乎还没完全敲定是哪个，其中有个叫帕累托分布的比较符合。

$$
f(x|x_0, α) = \frac{αx_0^α}{x^{α+1}}
$$

国统局说 22 年人均可支配收入平均值 36883 中位数 31370 查资料知道帕累托分布的期望和中位数计算公式，于是有

$$
E(X) = \frac{αx_0}{α - 1} = 36883\\
x_0\sqrt[α]{2} = 31370
$$

这个方程组解肯定是不会解的，试了几组参数，发现 $α = 3.15, x_0 = 25174$ 最接近，如果按这个参数来，90 分位是 52289，99 分位是 108610 似乎有点少，在一个 $x_0$ 是最小值，就是说最低都有 25174，这个和总理说的明显冲突。

这么来看，可支配收入可能不适合用这个分布

```
from scipy.stats import pareto
rv = pareto(b = 3.15, scale=25174)
rv.ppf(0.9)
```

另外多说一句，如果 X 是帕累托分布，那么 $log(X/x_0)$ 就是指数分布。

**贝塔分布**

有一个函数叫贝塔函数，so 有个分布叫贝塔分布

$$
B(α, β) = \frac{Γ(α)Γ(β)}{Γ(α + β)}
$$

结论很简单，证明过程用到多元的随机变量变换，反正也看不懂

很早之前有个例子，观察患者治愈情况，推测治愈概率

$$
g_2(p|x) = \frac{p^x(1-p)^{n-x}}{\int_0^1p^x(1-p)^{n-x}dp}
$$

那时候 P 用的是均匀分布 $f(p) = 1$

现在可以上更高级的了。

均匀分布 f(x) = 1 是 α + β 都等于 1 的贝塔分布

观察 n 次实验，x 次成功，它是 α + x 和 β + n - x 的贝塔分布

$$
E(p) = \frac{α}{α + β} = \frac{α + x}{α + β + n} = \frac{x + 1}{n + 2}
$$

好家伙

看过伽马和贝塔，我就想有没有阿尔法分布，搜了下还真有

$$
f(x|α, β) = \frac{β}{\sqrt{2\pi}\Phi(α)x^2}e^{-\frac{(α - (β/x))^2}{2}}
$$

这个就不知道干啥用的了，长得倒和正态分布有几分相似。

封面图：Twitter 心臓弱眞君 @xinzoruo